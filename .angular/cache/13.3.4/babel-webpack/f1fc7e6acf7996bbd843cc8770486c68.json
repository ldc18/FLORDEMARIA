{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { BehaviorSubject, from } from 'rxjs';\nimport { delay, take } from 'rxjs/operators';\nimport * as fromRoot from '../../../store/reducers';\nimport * as actions from '../../../store/actions';\nimport { languages } from '../../../shared/constants';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ngrx/store\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/material/form-field\";\nimport * as i5 from \"@angular/material/input\";\nimport * as i6 from \"@angular/material/button\";\nimport * as i7 from \"@angular/material/select\";\nimport * as i8 from \"@angular/material/core\";\nimport * as i9 from \"@angular/material/radio\";\nimport * as i10 from \"../../../pipes/translate.pipe\";\n\nfunction ConfigEditComponent_ng_container_0_mat_option_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 13);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const option_r6 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", option_r6.titleUrl);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", option_r6.titleUrl, \" \");\n  }\n}\n\nfunction ConfigEditComponent_ng_container_0_mat_option_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 13);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const option_r7 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", option_r7);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", option_r7, \" \");\n  }\n}\n\nfunction ConfigEditComponent_ng_container_0_form_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"form\", 14)(1, \"h2\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 15)(4, \"mat-form-field\", 3)(5, \"mat-label\");\n    i0.ɵɵtext(6, \"BasicShippingCost\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(7, \"input\", 16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"mat-form-field\", 3)(9, \"mat-label\");\n    i0.ɵɵtext(10, \"BasicShippingLimit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(11, \"input\", 17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"mat-form-field\", 3)(13, \"mat-label\");\n    i0.ɵɵtext(14, \"ExtendedShippingCost\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(15, \"input\", 18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"mat-form-field\", 3)(17, \"mat-label\");\n    i0.ɵɵtext(18, \"ExtendedShippingLimit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(19, \"input\", 19);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(20, \"mat-radio-group\", 20)(21, \"mat-radio-button\", 21);\n    i0.ɵɵtext(22);\n    i0.ɵɵpipe(23, \"async\");\n    i0.ɵɵpipe(24, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(25, \"mat-radio-button\", 22);\n    i0.ɵɵtext(26);\n    i0.ɵɵpipe(27, \"async\");\n    i0.ɵɵpipe(28, \"translate\");\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const chooseLang_r2 = i0.ɵɵnextContext().ngIf;\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r5.configEditForm);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r5.configEditForm.get(\"titleUrl\").value);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formGroupName\", chooseLang_r2);\n    i0.ɵɵadvance(18);\n    i0.ɵɵproperty(\"value\", true);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(23, 7, i0.ɵɵpipeBind1(24, 9, \"Active\")), \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"value\", false);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(27, 11, i0.ɵɵpipeBind1(28, 13, \"Inactive\")), \" \");\n  }\n}\n\nfunction ConfigEditComponent_ng_container_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 2)(2, \"div\")(3, \"mat-form-field\", 3)(4, \"mat-label\");\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"async\");\n    i0.ɵɵpipe(7, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"input\", 4);\n    i0.ɵɵlistener(\"ngModelChange\", function ConfigEditComponent_ng_container_0_Template_input_ngModelChange_8_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.newConfig = $event;\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"button\", 5);\n    i0.ɵɵlistener(\"click\", function ConfigEditComponent_ng_container_0_Template_button_click_9_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return ctx_r11.addConfig();\n    });\n    i0.ɵɵtext(10, \" + \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"mat-form-field\", 6)(12, \"mat-label\");\n    i0.ɵɵtext(13);\n    i0.ɵɵpipe(14, \"async\");\n    i0.ɵɵpipe(15, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"mat-select\", 7);\n    i0.ɵɵlistener(\"ngModelChange\", function ConfigEditComponent_ng_container_0_Template_mat_select_ngModelChange_16_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return ctx_r12.chosenConfig = $event;\n    })(\"ngModelChange\", function ConfigEditComponent_ng_container_0_Template_mat_select_ngModelChange_16_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return ctx_r13.choseConfig();\n    });\n    i0.ɵɵtemplate(17, ConfigEditComponent_ng_container_0_mat_option_17_Template, 2, 2, \"mat-option\", 8);\n    i0.ɵɵpipe(18, \"async\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(19, \"mat-form-field\", 9)(20, \"mat-label\");\n    i0.ɵɵtext(21);\n    i0.ɵɵpipe(22, \"async\");\n    i0.ɵɵpipe(23, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"mat-select\", 7);\n    i0.ɵɵlistener(\"ngModelChange\", function ConfigEditComponent_ng_container_0_Template_mat_select_ngModelChange_24_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return ctx_r14.setLang($event);\n    });\n    i0.ɵɵtemplate(25, ConfigEditComponent_ng_container_0_mat_option_25_Template, 2, 2, \"mat-option\", 8);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(26, ConfigEditComponent_ng_container_0_form_26_Template, 29, 15, \"form\", 10);\n    i0.ɵɵelementStart(27, \"div\", 11)(28, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function ConfigEditComponent_ng_container_0_Template_button_click_28_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return ctx_r15.saveConfig();\n    });\n    i0.ɵɵtext(29, \" Save \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(30, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function ConfigEditComponent_ng_container_0_Template_button_click_30_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return ctx_r16.removeConfig();\n    });\n    i0.ɵɵtext(31, \" Borrar \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const chooseLang_r2 = ctx.ngIf;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(6, 11, i0.ɵɵpipeBind1(7, 13, \"Add_Config\")));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.newConfig);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(14, 15, i0.ɵɵpipeBind1(15, 17, \"From_existing_config\")), \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.chosenConfig);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(18, 19, ctx_r0.configs$));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(22, 21, i0.ɵɵpipeBind1(23, 23, \"Language_for_config\")), \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", chooseLang_r2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.languageOptions);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.configEditForm.get(\"titleUrl\").value);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r0.configEditForm.invalid);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r0.configEditForm.invalid);\n  }\n}\n\nfunction ConfigEditComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 23)(1, \"span\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"async\");\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function ConfigEditComponent_div_2_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r18);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return ctx_r17.sendRequest = !ctx_r17.sendRequest;\n    });\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"async\");\n    i0.ɵɵpipe(8, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(3, 2, i0.ɵɵpipeBind1(4, 4, \"Request_sended\")), \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(7, 6, i0.ɵɵpipeBind1(8, 8, \"Again\")), \" \");\n  }\n}\n\nexport let ConfigEditComponent = /*#__PURE__*/(() => {\n  class ConfigEditComponent {\n    constructor(store, fb) {\n      this.store = store;\n      this.fb = fb;\n      this.languageOptions = languages;\n      this.choosenLanguageSub$ = new BehaviorSubject(languages[0]);\n      this.newConfig = '';\n      this.chosenConfig = '';\n      this.sendRequest = false;\n      this.store.dispatch(new actions.GetConfigs());\n      this.configEditForm = this.fb.group({\n        titleUrl: ['', Validators.required],\n        active: false,\n        ...this.createLangForm(this.languageOptions)\n      });\n      this.configs$ = this.store.select(fromRoot.getConfigs);\n    }\n\n    addConfig() {\n      if (this.newConfig) {\n        this.configEditForm.get('titleUrl').setValue(this.newConfig);\n      }\n    }\n\n    choseConfig() {\n      if (this.chosenConfig) {\n        this.configEditForm.get('titleUrl').setValue(this.chosenConfig);\n        this.configs$.pipe(take(1)).subscribe(configs => {\n          const foundConfig = configs.find(config => config.titleUrl === this.chosenConfig);\n          const newForm = {\n            titleUrl: foundConfig.titleUrl,\n            active: foundConfig.active,\n            ...this.languageOptions.map(lang => ({\n              [lang]: {\n                basicShippingCost: foundConfig[lang].shippingCost.basic.cost || 0,\n                basicShippingLimit: foundConfig[lang].shippingCost.basic.limit || 0,\n                extendedShippingCost: foundConfig[lang].shippingCost.extended.cost || 0,\n                extendedShippingLimit: foundConfig[lang].shippingCost.extended.limit || 0\n              }\n            })).reduce((prev, curr) => ({ ...prev,\n              ...curr\n            }), {})\n          };\n          this.configEditForm.setValue(newForm);\n        });\n      }\n    }\n\n    setLang(lang) {\n      this.choosenLanguageSub$.next('');\n      from(lang).pipe(delay(100)).subscribe(() => {\n        this.choosenLanguageSub$.next(lang);\n      });\n    }\n\n    saveConfig() {\n      const formValues = this.configEditForm.value;\n      const request = {\n        titleUrl: formValues.titleUrl,\n        active: formValues.active,\n        ...this.languageOptions.map(lang => ({\n          [lang]: {\n            shippingCost: {\n              basic: {\n                cost: formValues[lang].basicShippingCost,\n                limit: formValues[lang].basicShippingLimit\n              },\n              extended: {\n                cost: formValues[lang].extendedShippingCost,\n                limit: formValues[lang].extendedShippingLimit\n              }\n            }\n          }\n        })).reduce((prev, curr) => ({ ...prev,\n          ...curr\n        }), {})\n      };\n      this.store.dispatch(new actions.AddOrEditConfig(request));\n      this.sendRequest = true;\n    }\n\n    removeConfig() {\n      this.store.dispatch(new actions.RemoveConfig(this.chosenConfig));\n      this.sendRequest = true;\n    }\n\n    createLangForm(languageOptions) {\n      return languageOptions.map(lang => ({\n        [lang]: this.fb.group({\n          basicShippingCost: 0,\n          basicShippingLimit: 0,\n          extendedShippingCost: 0,\n          extendedShippingLimit: 0\n        })\n      })).reduce((prev, curr) => ({ ...prev,\n        ...curr\n      }), {});\n    }\n\n  }\n\n  ConfigEditComponent.ɵfac = function ConfigEditComponent_Factory(t) {\n    return new (t || ConfigEditComponent)(i0.ɵɵdirectiveInject(i1.Store), i0.ɵɵdirectiveInject(i2.FormBuilder));\n  };\n\n  ConfigEditComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ConfigEditComponent,\n    selectors: [[\"app-config-edit\"]],\n    decls: 3,\n    vars: 4,\n    consts: [[4, \"ngIf\"], [\"class\", \"config_edit-after-send\", 4, \"ngIf\"], [1, \"config_edit-top\"], [1, \"config_edit-field\"], [\"matInput\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"mat-flat-button\", \"\", \"color\", \"accent\", 1, \"translations-button\", 3, \"click\"], [1, \"config-select\"], [3, \"ngModel\", \"ngModelChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [1, \"lang-select\"], [\"class\", \"config_edit-form\", 3, \"formGroup\", 4, \"ngIf\"], [1, \"config_edit-cta\"], [\"mat-flat-button\", \"\", \"color\", \"primary\", 3, \"disabled\", \"click\"], [3, \"value\"], [1, \"config_edit-form\", 3, \"formGroup\"], [3, \"formGroupName\"], [\"matInput\", \"\", \"type\", \"number\", \"formControlName\", \"basicShippingCost\"], [\"matInput\", \"\", \"type\", \"number\", \"formControlName\", \"basicShippingLimit\"], [\"matInput\", \"\", \"type\", \"number\", \"formControlName\", \"extendedShippingCost\"], [\"matInput\", \"\", \"type\", \"number\", \"formControlName\", \"extendedShippingLimit\"], [\"aria-label\", \"Active\", \"formControlName\", \"active\"], [\"name\", \"active\", \"id\", \"active\", 3, \"value\"], [\"name\", \"inactive\", \"id\", \"inactive\", 3, \"value\"], [1, \"config_edit-after-send\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 1, \"product_edit-btn-action\", 3, \"click\"]],\n    template: function ConfigEditComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, ConfigEditComponent_ng_container_0_Template, 32, 25, \"ng-container\", 0);\n        i0.ɵɵpipe(1, \"async\");\n        i0.ɵɵtemplate(2, ConfigEditComponent_div_2_Template, 9, 10, \"div\", 1);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", !ctx.sendRequest && i0.ɵɵpipeBind1(1, 2, ctx.choosenLanguageSub$));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.sendRequest);\n      }\n    },\n    directives: [i3.NgIf, i4.MatFormField, i4.MatLabel, i5.MatInput, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgModel, i6.MatButton, i7.MatSelect, i3.NgForOf, i8.MatOption, i2.ɵNgNoValidate, i2.NgControlStatusGroup, i2.FormGroupDirective, i2.FormGroupName, i2.NumberValueAccessor, i2.FormControlName, i9.MatRadioGroup, i9.MatRadioButton],\n    pipes: [i3.AsyncPipe, i10.TranslatePipe],\n    styles: [\"[_nghost-%COMP%]     .mat-radio-button~.mat-radio-button{margin-left:16px}@media screen and (max-width: 600px){[_nghost-%COMP%]     .mat-radio-button~.mat-radio-button{margin-left:4px}}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]{background:#fff}[_nghost-%COMP%]   .config_edit-top[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between}[_nghost-%COMP%]   .config_edit-after-send[_ngcontent-%COMP%]{display:flex;align-items:center;padding:50px}[_nghost-%COMP%]   .config_edit-cta[_ngcontent-%COMP%]{margin:20px 0;display:flex;justify-content:space-between;width:50%}\"]\n  });\n  return ConfigEditComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}