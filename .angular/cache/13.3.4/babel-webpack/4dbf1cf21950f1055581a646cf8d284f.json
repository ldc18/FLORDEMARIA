{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { BehaviorSubject, from } from 'rxjs';\nimport { delay, take } from 'rxjs/operators';\nimport * as fromRoot from '../../../store/reducers';\nimport * as actions from '../../../store/actions';\nimport { languages } from '../../../shared/constants';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ngrx/store\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/material/form-field\";\nimport * as i5 from \"@angular/material/input\";\nimport * as i6 from \"@angular/material/button\";\nimport * as i7 from \"@angular/material/select\";\nimport * as i8 from \"@angular/material/core\";\nimport * as i9 from \"../tiny-editor.ts/tiny-editor.component\";\nimport * as i10 from \"../../../pipes/translate.pipe\";\n\nfunction PagesEditComponent_ng_container_0_mat_option_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 12);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const option_r6 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", option_r6.titleUrl);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", option_r6.titleUrl, \" \");\n  }\n}\n\nfunction PagesEditComponent_ng_container_0_mat_option_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 12);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const option_r7 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", option_r7);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", option_r7, \" \");\n  }\n}\n\nfunction PagesEditComponent_ng_container_0_form_26_app_tiny_editor_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-tiny-editor\", 17);\n    i0.ɵɵlistener(\"editorContentChange\", function PagesEditComponent_ng_container_0_form_26_app_tiny_editor_8_Template_app_tiny_editor_editorContentChange_0_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const chooseLang_r2 = i0.ɵɵnextContext(2).ngIf;\n      const ctx_r10 = i0.ɵɵnextContext();\n      return ctx_r10.onPageEditorChange($event, chooseLang_r2);\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const langValue_r9 = ctx.ngIf;\n    i0.ɵɵproperty(\"description\", langValue_r9.contentHTML);\n  }\n}\n\nfunction PagesEditComponent_ng_container_0_form_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"form\", 13)(1, \"h2\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 14)(4, \"mat-form-field\", 3)(5, \"mat-label\");\n    i0.ɵɵtext(6, \"Title\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(7, \"input\", 15);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(8, PagesEditComponent_ng_container_0_form_26_app_tiny_editor_8_Template, 1, 1, \"app-tiny-editor\", 16);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const chooseLang_r2 = i0.ɵɵnextContext().ngIf;\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r5.pagesEditForm);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r5.pagesEditForm.get(\"titleUrl\").value);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formGroupName\", chooseLang_r2);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.pagesEditForm.get(chooseLang_r2).value);\n  }\n}\n\nfunction PagesEditComponent_ng_container_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 2)(2, \"div\")(3, \"mat-form-field\", 3)(4, \"mat-label\");\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"async\");\n    i0.ɵɵpipe(7, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"input\", 4);\n    i0.ɵɵlistener(\"ngModelChange\", function PagesEditComponent_ng_container_0_Template_input_ngModelChange_8_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return ctx_r14.newPage = $event;\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"button\", 5);\n    i0.ɵɵlistener(\"click\", function PagesEditComponent_ng_container_0_Template_button_click_9_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return ctx_r16.addPage();\n    });\n    i0.ɵɵtext(10, \" + \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"mat-form-field\", 6)(12, \"mat-label\");\n    i0.ɵɵtext(13);\n    i0.ɵɵpipe(14, \"async\");\n    i0.ɵɵpipe(15, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"mat-select\", 7);\n    i0.ɵɵlistener(\"ngModelChange\", function PagesEditComponent_ng_container_0_Template_mat_select_ngModelChange_16_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return ctx_r17.chosenPage = $event;\n    })(\"ngModelChange\", function PagesEditComponent_ng_container_0_Template_mat_select_ngModelChange_16_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r18 = i0.ɵɵnextContext();\n      return ctx_r18.chosePage();\n    });\n    i0.ɵɵtemplate(17, PagesEditComponent_ng_container_0_mat_option_17_Template, 2, 2, \"mat-option\", 8);\n    i0.ɵɵpipe(18, \"async\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(19, \"mat-form-field\", 9)(20, \"mat-label\");\n    i0.ɵɵtext(21);\n    i0.ɵɵpipe(22, \"async\");\n    i0.ɵɵpipe(23, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"mat-select\", 7);\n    i0.ɵɵlistener(\"ngModelChange\", function PagesEditComponent_ng_container_0_Template_mat_select_ngModelChange_24_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r19 = i0.ɵɵnextContext();\n      return ctx_r19.setLang($event);\n    });\n    i0.ɵɵtemplate(25, PagesEditComponent_ng_container_0_mat_option_25_Template, 2, 2, \"mat-option\", 8);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(26, PagesEditComponent_ng_container_0_form_26_Template, 9, 4, \"form\", 10);\n    i0.ɵɵelementStart(27, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function PagesEditComponent_ng_container_0_Template_button_click_27_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r20 = i0.ɵɵnextContext();\n      return ctx_r20.savePage();\n    });\n    i0.ɵɵtext(28, \" Save \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(29, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function PagesEditComponent_ng_container_0_Template_button_click_29_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r21 = i0.ɵɵnextContext();\n      return ctx_r21.removePage();\n    });\n    i0.ɵɵtext(30, \" Remove \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const chooseLang_r2 = ctx.ngIf;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(6, 11, i0.ɵɵpipeBind1(7, 13, \"Add_page\")));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.newPage);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(14, 15, i0.ɵɵpipeBind1(15, 17, \"From_existing_pages\")), \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.chosenPage);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(18, 19, ctx_r0.pages$));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(22, 21, i0.ɵɵpipeBind1(23, 23, \"Language_for_page\")), \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", chooseLang_r2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.languageOptions);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.pagesEditForm.get(\"titleUrl\").value);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", ctx_r0.pagesEditForm.invalid);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r0.pagesEditForm.invalid);\n  }\n}\n\nfunction PagesEditComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r23 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 18)(1, \"span\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"async\");\n    i0.ɵɵpipe(4, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function PagesEditComponent_div_2_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r23);\n      const ctx_r22 = i0.ɵɵnextContext();\n      return ctx_r22.sendRequest = !ctx_r22.sendRequest;\n    });\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"async\");\n    i0.ɵɵpipe(8, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(3, 2, i0.ɵɵpipeBind1(4, 4, \"Request_sended\")), \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(7, 6, i0.ɵɵpipeBind1(8, 8, \"Again\")), \" \");\n  }\n}\n\nexport let PagesEditComponent = /*#__PURE__*/(() => {\n  class PagesEditComponent {\n    constructor(store, fb) {\n      this.store = store;\n      this.fb = fb;\n      this.languageOptions = languages;\n      this.choosenLanguageSub$ = new BehaviorSubject(languages[0]);\n      this.newPage = '';\n      this.chosenPage = '';\n      this.sendRequest = false;\n      this.store.dispatch(new actions.GetPages());\n      this.pagesEditForm = this.fb.group({\n        titleUrl: ['', Validators.required],\n        ...this.createLangForm(this.languageOptions)\n      });\n      this.pages$ = this.store.select(fromRoot.getPages);\n    }\n\n    onPageEditorChange(content, lang) {\n      this.pagesEditForm.get(lang).get('contentHTML').setValue(content);\n    }\n\n    addPage() {\n      if (this.newPage) {\n        this.pagesEditForm.get('titleUrl').setValue(this.newPage);\n        this.languageOptions.forEach(lang => {\n          this.pagesEditForm.get(lang).get('title').setValue(this.newPage);\n        });\n      }\n    }\n\n    chosePage() {\n      if (this.chosenPage) {\n        this.pagesEditForm.get('titleUrl').setValue(this.chosenPage);\n        this.pages$.pipe(take(1)).subscribe(pages => {\n          const foundPage = pages.find(page => page.titleUrl === this.chosenPage);\n          this.languageOptions.forEach(lang => {\n            this.pagesEditForm.get(lang).get('title').setValue(foundPage[lang].title);\n            this.pagesEditForm.get(lang).get('contentHTML').setValue(foundPage[lang].contentHTML);\n          });\n        });\n      }\n    }\n\n    setLang(lang) {\n      this.choosenLanguageSub$.next('');\n      from(lang).pipe(delay(100)).subscribe(() => {\n        this.choosenLanguageSub$.next(lang);\n      });\n    }\n\n    savePage() {\n      const request = this.pagesEditForm.value;\n      this.store.dispatch(new actions.AddOrEditPage(request));\n      this.sendRequest = true;\n    }\n\n    removePage() {\n      this.store.dispatch(new actions.RemovePage(this.chosenPage));\n      this.sendRequest = true;\n    }\n\n    createLangForm(languageOptions) {\n      return languageOptions.map(lang => ({\n        [lang]: this.fb.group({\n          title: '',\n          contentHTML: ''\n        })\n      })).reduce((prev, curr) => ({ ...prev,\n        ...curr\n      }), {});\n    }\n\n  }\n\n  PagesEditComponent.ɵfac = function PagesEditComponent_Factory(t) {\n    return new (t || PagesEditComponent)(i0.ɵɵdirectiveInject(i1.Store), i0.ɵɵdirectiveInject(i2.FormBuilder));\n  };\n\n  PagesEditComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PagesEditComponent,\n    selectors: [[\"app-pages-edit\"]],\n    decls: 3,\n    vars: 4,\n    consts: [[4, \"ngIf\"], [\"class\", \"pages_edit-after-send\", 4, \"ngIf\"], [1, \"pages_edit-top\"], [1, \"pages_edit-field\"], [\"matInput\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"mat-flat-button\", \"\", \"color\", \"accent\", 1, \"translations-button\", 3, \"click\"], [1, \"page-select\"], [3, \"ngModel\", \"ngModelChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [1, \"lang-select\"], [\"class\", \"pages_edit-form\", 3, \"formGroup\", 4, \"ngIf\"], [\"mat-flat-button\", \"\", \"color\", \"primary\", 3, \"disabled\", \"click\"], [3, \"value\"], [1, \"pages_edit-form\", 3, \"formGroup\"], [3, \"formGroupName\"], [\"matInput\", \"\", \"formControlName\", \"title\"], [3, \"description\", \"editorContentChange\", 4, \"ngIf\"], [3, \"description\", \"editorContentChange\"], [1, \"pages_edit-after-send\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 1, \"product_edit-btn-action\", 3, \"click\"]],\n    template: function PagesEditComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, PagesEditComponent_ng_container_0_Template, 31, 25, \"ng-container\", 0);\n        i0.ɵɵpipe(1, \"async\");\n        i0.ɵɵtemplate(2, PagesEditComponent_div_2_Template, 9, 10, \"div\", 1);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", !ctx.sendRequest && i0.ɵɵpipeBind1(1, 2, ctx.choosenLanguageSub$));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.sendRequest);\n      }\n    },\n    directives: [i3.NgIf, i4.MatFormField, i4.MatLabel, i5.MatInput, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgModel, i6.MatButton, i7.MatSelect, i3.NgForOf, i8.MatOption, i2.ɵNgNoValidate, i2.NgControlStatusGroup, i2.FormGroupDirective, i2.FormGroupName, i2.FormControlName, i9.TinyEditorComponent],\n    pipes: [i3.AsyncPipe, i10.TranslatePipe],\n    styles: [\"[_nghost-%COMP%]   .main[_ngcontent-%COMP%]{background:#fff}[_nghost-%COMP%]   .pages_edit-top[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between}[_nghost-%COMP%]   .pages_edit-after-send[_ngcontent-%COMP%]{display:flex;align-items:center;padding:50px}\"]\n  });\n  return PagesEditComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}